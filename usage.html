<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2015-04-22 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>NinthTest JCA Provider - Using the NinthTest JCA Provider</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Matthew Zipay" />
    <meta name="Date-Revision-yyyymmdd" content="20150422" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                NinthTest JCA Provider
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-04-22</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1.0</span>
                      </div>
            <div class="xright">                    <a href="http://www.ninthtest.net/" class="externalLink" title="NinthTest.net">NinthTest.net</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="services.html" title="Security Services">Security Services</a>
            </li>
                  <li class="none">
                          <a href="download.html" title="Download & Installation">Download & Installation</a>
            </li>
                  <li class="none">
            <strong>Usage</strong>
          </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                          <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Copyright (c) 2011-2014 Matthew Zipay <mattz@ninthtest.net> --><!--  --><!-- This file is part of the NinthTest JCA Provider. --><!--  --><!-- The NinthTest JCA Provider is free software: you can redistribute it and/or --><!-- modify it under the terms of the GNU General Public License as published by --><!-- the Free Software Foundation, either version 3 of the License, or (at your --><!-- option) any later version. --><!--  --><!-- The NinthTest JCA Provider is distributed in the hope that it will be --><!-- useful, but WITHOUT ANY WARRANTY; without even the implied warranty of --><!-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General --><!-- Public License for more details. --><!--  --><!-- You should have received a copy of the GNU General Public License along with --><!-- the NinthTest JCA Provider. If not, see <http://www.gnu.org/licenses/>. --><div class="section">
<h2>Using the NinthTest JCA Provider<a name="Using_the_NinthTest_JCA_Provider"></a></h2>
<p>The following sections show code examples of common/recommended usage scenarios by algorithm.</p>
<p>These examples are not exhaustive; please refer to the <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html#CoreClasses"> Java&#x2122; Cryptography Architecture Core Classes and Interfaces</a> and the <a href="./apidocs/index.html">NinthTest JCA Provider API documentation</a> for more information.</p>
<p>Please refer to <a href="./services.html">Security services provided by the NinthTest JCA provider</a> for more detailed information about the supported algorithms and services.</p>
<div class="section">
<h3>Helix<a name="Helix"></a></h3>
<div class="section">
<h4>Creating Helix secret keys<a name="Creating_Helix_secret_keys"></a></h4>
<div class="section">
<h5>Generate a 256-bit random secret key<a name="Generate_a_256-bit_random_secret_key"></a></h5>
<p>The recommended Helix key size is 256 bits (which is also the <i>maximum</i> key size). The NinthTest JCA Provider uses a 256-bit key size as the default when generating a random secret key.</p>
<div class="source">
<pre>KeyGenerator keyGenerator = KeyGenerator.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
SecretKey secretKey = keyGenerator.generateKey();</pre></div></div>
<div class="section">
<h5>Generate a random secret key of a specified size<a name="Generate_a_random_secret_key_of_a_specified_size"></a></h5>
<p>Initialize the key generator with a size in bits (must be less than 256 and a multiple of eight) to create a secret key with a specified size.</p>
<p><b>Key sizes less than 128 bits are not recommended.</b></p>
<div class="source">
<pre>KeyGenerator keyGenerator = KeyGenerator.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
keyGenerator.init(192);
SecretKey secretKey = keyGenerator.generateKey();</pre></div></div>
<div class="section">
<h5>Generate a secret key from key material<a name="Generate_a_secret_key_from_key_material"></a></h5>
<p>Store the raw bytes in a Helix key specification, then use a secret key factory to create the secret key.</p>
<div class="source">
<pre>byte[] keyMaterial = &quot;KeepMeSecret&quot;.getBytes(&quot;UTF-8&quot;);
HelixKeySpec keySpec = new HelixKeySpec(keyMaterial);
SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
SecretKey secretKey = keyFactory.generateSecret(keySpec);</pre></div>
<p>See:</p>
<ul>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/KeyGenerator.html">javax.crypto.KeyGenerator</a></tt></li>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/SecretKey.html">javax.crypto.SecretKey</a></tt></li>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/SecretKeyFactory.html">javax.crypto.SecretKeyFactory</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixKeyGenerator.html">net.ninthtest.crypto.provider.helix.HelixKeyGenerator</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixKeySpec.html">net.ninthtest.crypto.provider.helix.HelixKeySpec</a></tt></li></ul></div></div>
<div class="section">
<h4>Helix encryption<a name="Helix_encryption"></a></h4>
<div class="section">
<h5>Initialize the Helix cipher with a randomly-generated nonce<a name="Initialize_the_Helix_cipher_with_a_randomly-generated_nonce"></a></h5>
<p>Initializing the cipher for encryption <i>without</i> specifying a nonce causes the NinthTest JCA Provider to generate a random nonce. <b>Be sure to save the generated nonce, as it will be required for decryption!</b></p>
<div class="source">
<pre>Cipher cipher = Cipher.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
cipher.init(Cipher.ENCRYPT_MODE, secretKey);
byte[] randomNonce = cipher.getIV();</pre></div></div>
<div class="section">
<h5>Initialize the Helix cipher with an explicit nonce<a name="Initialize_the_Helix_cipher_with_an_explicit_nonce"></a></h5>
<p>Store the nonce bytes in a Helix parameter specification, then initialize the cipher for encryption. The nonce <i>must</i> be 16 bytes in length.</p>
<div class="source">
<pre>byte[] nonce = &quot;MustBe16Bytes!!!&quot;.getBytes(&quot;UTF-8&quot;);
HelixParameterSpec paramSpec = new HelixParameterSpec(nonce);
Cipher cipher = Cipher.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
cipher.init(Cipher.ENCRYPT_MODE, secretKey, paramSpec);</pre></div></div>
<div class="section">
<h5>Retrieve the generated MAC after encryption<a name="Retrieve_the_generated_MAC_after_encryption"></a></h5>
<p>Use the algorithm parameters returned by the cipher <i>after</i> a successful encryption operation (but <i>before</i> calling <tt>Cipher#init()</tt> again) to obtain the generated MAC bytes.</p>
<div class="source">
<pre>...
byte[] cipherText = cipher.doFinal(plainText);
AlgorithmParameters params = cipher.getParameters();
HelixParameterSpec paramSpec = params.getParameterSpec(HelixParameterSpec.class);
byte[] generatedMac = paramSpec.getMac();</pre></div>
<p>See:</p>
<ul>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/security/AlgorithmParameters.html">java.security.AlgorithmParameters</a></tt></li>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/Cipher.html">javax.crypto.Cipher</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixAlgorithmParameters.html">net.ninthtest.crypto.provider.helix.HelixAlgorithmParameters</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixCipher.html">net.ninthtest.crypto.provider.helix.HelixCipher</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixParameterSpec.html">net.ninthtest.crypto.provider.helix.HelixParameterSpec</a></tt></li></ul></div></div>
<div class="section">
<h4>Helix message authentication<a name="Helix_message_authentication"></a></h4>
<p><b>Note:</b> It is not possible to initialize a Helix <tt>Mac</tt> <i>without</i> a Helix parameter specification, because Helix requires a nonce.</p>
<div class="section">
<h5>Generate a Helix MAC using a random nonce<a name="Generate_a_Helix_MAC_using_a_random_nonce"></a></h5>
<p>Use a secure random number generator to generate the random nonce. Be sure to save this generated nonce; you must use the <i>same</i> nonce for encryption/decryption in order for the generated MAC to be useful.</p>
<div class="source">
<pre>SecureRandom prng = new SecureRandom();
byte[] randomNonce = new byte[16];
prng.nextBytes(randomNonce);
HelixParameterSpec paramSpec = new HelixParameterSpec(randomNonce);
Mac macFunction = Mac.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
macFunction.init(secretKey, paramSpec);
byte[] mac = macFunction.doFinal(plainText);</pre></div></div>
<div class="section">
<h5>Generate a Helix MAC using a specified nonce<a name="Generate_a_Helix_MAC_using_a_specified_nonce"></a></h5>
<div class="source">
<pre>byte[] nonce = &quot;MustBe16Bytes!!!&quot;.getBytes(&quot;UTF-8&quot;);
HelixParameterSpec paramSpec = new HelixParameterSpec(nonce);
Mac macFunction = Mac.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
macFunction.init(secretKey, paramSpec);
byte[] mac = macFunction.doFinal(plainText);</pre></div>
<p>See:</p>
<ul>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html">java.security.SecureRandom</a></tt></li>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/Mac.html">javax.crypto.Mac</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixParameterSpec.html">net.ninthtest.crypto.provider.helix.HelixParameterSpec</a></tt></li></ul></div></div>
<div class="section">
<h4>Helix decryption<a name="Helix_decryption"></a></h4>
<div class="section">
<h5>Decrypt <i>and</i> authenticate a message<a name="Decrypt_and_authenticate_a_message"></a></h5>
<p>Specify the expected MAC as part of the Helix parameter specification. If message authentication fails, an exception is thrown.</p>
<div class="source">
<pre>HelixParameterSpec paramSpec = new HelixParameterSpec(nonce, expectedMac);
Cipher cipher = Cipher.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
cipher.init(Cipher.DECRYPT_MODE, secretKey, paramSpec);
// throws MessageAuthenticationException if message authentication fails
byte[] plainText = cipher.doFinal(cipherText);</pre></div></div>
<div class="section">
<h5>Decrypt <i>only</i><a name="Decrypt_only"></a></h5>
<p>Do not include the expected MAC as part of the Helix parameter specification. Message authentication will be bypassed (i.e. Helix will be used as a pure stream cipher).</p>
<div class="source">
<pre>HelixParameterSpec paramSpec = new HelixParameterSpec(nonce);
Cipher cipher = Cipher.getInstance(&quot;Helix&quot;, &quot;NinthTest&quot;);
cipher.init(Cipher.DECRYPT_MODE, secretKey, paramSpec);
// message authentication is not attempted
byte[] plainText = cipher.doFinal(cipherText);</pre></div>
<p>See:</p>
<ul>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/javax/crypto/Cipher.html">javax.crypto.Cipher</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/MessageAuthenticationException.html">net.ninthtest.crypto.MessageAuthenticationException</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixCipher.html">net.ninthtest.crypto.provider.helix.HelixCipher</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixParameterSpec.html">net.ninthtest.crypto.provider.helix.HelixParameterSpec</a></tt></li></ul></div></div>
<div class="section">
<h4>Helix pseudo-random number generation (PRNG)<a name="Helix_pseudo-random_number_generation_PRNG"></a></h4>
<div class="section">
<h5>Generate pseudo-random numbers using Helix<a name="Generate_pseudo-random_numbers_using_Helix"></a></h5>
<div class="source">
<pre>SecureRandom prng = SecureRandom.getInstance(&quot;Helix&quot;);
byte bytes[] = new byte[16];
prng.nextBytes(bytes);</pre></div>
<p>See:</p>
<ul>
<li><tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html">java.security.SecureRandom</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/provider/helix/HelixSecureRandom.html">net.ninthtest.crypto.provider.helix.HelixSecureRandom</a></tt></li></ul></div></div>
<div class="section">
<h4>Non-provider usage of Helix<a name="Non-provider_usage_of_Helix"></a></h4>
<p>The Helix cryptographic primitive may also be used independently of the JCA by using the classes defined in the <tt>net.ninthtest.crypto.helix</tt> package.</p>
<div class="section">
<h5>Non-provider Helix encryption<a name="Non-provider_Helix_encryption"></a></h5>
<div class="source">
<pre>HelixPrimitive helixEncryption = new HelixEncryption(key, nonce);
byte[] cipherText = helixEncryption.finish(plainText);
byte[] generatedMac = helixEncryption.getGeneratedMac();</pre></div></div>
<div class="section">
<h5>Non-provider Helix decryption <i>with</i> MAC verification<a name="Non-provider_Helix_decryption_with_MAC_verification"></a></h5>
<p>Specify the expected MAC when constructing <tt>HelixDecryption</tt>. If message authentication fails, an exception is thrown.</p>
<div class="source">
<pre>HelixPrimitive helixDecryption = new HelixDecryption(key, nonce, expectedMac);
// throws MessageAuthenticationException if expected MAC != generated MAC
byte[] plaintText = helixEncryption.finish(cipherText);</pre></div></div>
<div class="section">
<h5>Non-provider Helix decryption <i>only</i><a name="Non-provider_Helix_decryption_only"></a></h5>
<p>Do not include the expected MAC when constructing <tt>HelixDecryption</tt>. Message authentication will be bypassed (i.e. Helix will be used as a pure stream cipher).</p>
<div class="source">
<pre>HelixPrimitive helixDecryption = new HelixDecryption(key, nonce);
// message authentication is not attempted
byte[] plaintText = helixEncryption.finish(cipherText);</pre></div></div>
<div class="section">
<h5>Non-provider Helix pseudo-random number generation<a name="Non-provider_Helix_pseudo-random_number_generation"></a></h5>
<p>The <tt>HelixRandom</tt> class is a subclass of <tt><a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/util/Random.html">java.util.Random</a></tt>.</p>
<div class="source">
<pre>Random rand = new HelixRandom();
int digit = rand.nextInt(10);</pre></div>
<p>See:</p>
<ul>
<li><tt><a href="./apidocs/net/ninthtest/crypto/helix/HelixDecryption.html">net.ninthtest.crypto.helix.HelixDecryption</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/helix/HelixEncryption.html">net.ninthtest.crypto.helix.HelixEncryption</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/helix/HelixPrimitive.html">net.ninthtest.crypto.helix.HelixPrimitive</a></tt></li>
<li><tt><a href="./apidocs/net/ninthtest/crypto/helix/HelixRandom.html">net.ninthtest.crypto.helix.HelixRandom</a></tt></li></ul></div></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2010-2015
                        <a href="http://ninthtest.net/">Matthew Zipay</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
